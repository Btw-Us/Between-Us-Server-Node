[supervisord]
nodaemon=true
logfile=/var/log/supervisord.log
pidfile=/var/run/supervisord.pid
user=root

[program:pocketbase]
command=/usr/local/bin/pocketbase serve --http=0.0.0.0:8090 --dir=/pb/pb_data
directory=/pb
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=1

[program:nodejs]
command=node /app/dist/index.js
directory=/app
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=2
environment=POCKETBASE_URL="%(ENV_POCKETBASE_URL)s",POCKETBASE_ADMIN_EMAIL="%(ENV_POCKETBASE_ADMIN_EMAIL)s",POCKETBASE_ADMIN_PASSWORD="%(ENV_POCKETBASE_ADMIN_PASSWORD)s",PORT="%(ENV_PORT)s",SERVER_JWT_SECRET="%(ENV_SERVER_JWT_SECRET)s"
